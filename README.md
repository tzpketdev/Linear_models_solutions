## Описание проделанной работы
# Предобработка данных
1) Было удалено 1159 данных из train датасет
2) Переменные mileage, engine, max_power были очищены от нечисловых значений
3) Переменная torque была преобразована в torque и max_torque с учетом единиц измерения
4) Пропуски в списке переменных ('mileage', 'engine', 'max_power', 'torque', 'seats') были заменены на медиану по train датасету
5) Переменной engine были присвоен целочисленный тип данных, а переменной seats строчный
6) Числовые признаки были обработаны шкалипованием StandardScaler, а строчные OneHotEncoder
# EDA
1) В ходе анализа удалось установить, что признак max_power положительно скорелирован с признаком engine, при том, что оба признака имеют средне-высокую линейную связь с таргетом, что в последствии говорит о мультиколлинеарности, которая ведет к нестабильной работе модели на новых данных и переобучению
2) Признак max_power слабо положительно скорелирован с годом выпуска авто
3) Признак mileage отрицательно коррелирует с engine
4) В остальном многие признаки не имеют сильной корреляции, что не может не радовать(иначе проблемы с мультикорреляцией)
5) engine и year показали наименьшую корреляцию среди всех пар
6) max_power и engine с значением корреляции в 0.68, а также seats и engine с значением корреляции в 0.65
7) У engine и seats также наблюдается средне-высокая корреляция, однако она действует до определенного значения engine, нужно более детально посмотреть на этот признак с ценой
8) Чтобы получить наибольший вклад от переменной seats для нее необходимо сделать bining, поскольку очевидно, что данный признак имеет не совмем линейную связь с таргетом, а bining поможет сделать зависимость линейной. В последствии данная переменная была переведана в ранг категориальных, что позволило иначе решить данную проблему
9) Судя по ящикам с усами во многих признаках присутствуют выбросы, исключив которые можно улучшить качество модели
# Построение моделей
Были исследованы следующие линейные модели: Линейная регрессия без регуляризации, а также с L1, L2 резуляризациями, а также их совмещением (ElasticNet).
При помощи кроссвалидации и подбора гиперпараметров было установлено, что лучший R2_score получается на Линейной регрессии с L2(Ridge). Для Ridge лучший коэффициент регуляризации = 10, а метрика R2_score ~0.627. Метрики данной модели на train и test:
R2 Train: 0.66
R2 Test: 0.66
MSE Train: 97180511931
MSE Test: 197472807143
# Feature Engineering
Качество модели не изменилось, либо ухудшилось:
1) Возведение year в квадрат
2) Объединение малочисленных и похожих по смыслу категорий для категориальных переменных для seller_type, fuel, owner
3) Очищение данных от выбросов по переменной engine
Качество модели улучшилось:
1) Очищение данных от выбросов по году (>1990 года)
2) Очищение данных от выбросов по стоимости (<6 000 000)
В результате качество модели по r2_score улушилось до ~0.643
# Реализацию сервиса по предсказанию цен на авто
Реализация представлена в файле model_solution.py
В ходе реализации сервиса были созданы 2 функции:

- predict_item, функция возвращает предсказания стоимости машины на основе входных данных по одной машие, пример работы:

![image](https://github.com/tzpketdev/Linear_models_solutions/assets/146220094/8a284c90-7f55-40c8-901b-416f14bf87b9)

- predict_items, функция возвращает предсказания стоимости машин на основе входных данных по нескольким машинам, пример работы:

![image](https://github.com/tzpketdev/Linear_models_solutions/assets/146220094/acbeb5bb-ed3a-4a81-98f7-c7fee80f74bb)




